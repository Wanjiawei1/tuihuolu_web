# 退火炉监控系统 - 简单部署指南

## 🚀 快速部署（3分钟完成）

### 前提条件
- 已安装 Node.js（版本 14+ 推荐）
- 有网络连接

### 部署步骤

#### 1. 获取代码
```bash
# 方法一：Git克隆（推荐）
git clone https://github.com/Wanjiawei1/tuihuolu_web.git
cd tuihuolu_web

# 方法二：直接下载
# 访问 https://github.com/Wanjiawei1/tuihuolu_web
# 点击 "Code" -> "Download ZIP"
# 解压到目标文件夹
```

#### 2. 安装依赖
```bash
npm install
```

#### 3. 启动系统
```bash
node server.js
```

#### 4. 访问系统
打开浏览器访问：**http://localhost:3000**

---

## ✅ 验证部署成功

看到以下信息说明部署成功：
```
HTTP 服务已启动: http://localhost:3000
✅ 已连接至 MQTT 服务器，clientId: viewer_xxxxxxxx
📡 已订阅主题: /dxiot/4q/get/danzhan/tuihuolu, /dxiot/4q/pub/danzhan/tuihuolu
🟢 Web 客户端已连接
```

---

## 🔧 生产环境部署

### 使用PM2（推荐）
```bash
# 安装PM2
npm install -g pm2

# 启动应用
pm2 start server.js --name tuihuolu-monitor

# 设置开机自启
pm2 startup
pm2 save

# 管理命令
pm2 status      # 查看状态
pm2 restart all # 重启
pm2 logs        # 查看日志
```

### 使用Docker
```bash
# 构建镜像
docker build -t tuihuolu-monitor .

# 运行容器
docker run -d --name tuihuolu-monitor -p 3000:3000 tuihuolu-monitor
```

---

## 📝 配置说明

### 端口配置
默认端口：`3000`
修改方法：编辑 `server.js` 文件中的 `PORT` 变量

### MQTT配置
默认MQTT服务器：`mqtt://Mqtt.dxiot.liju.cc`
修改方法：编辑 `server.js` 文件中的 `MQTT_BROKER_URL` 变量

---

## 🚨 常见问题

### 问题1：端口被占用
**错误信息**：`Error: listen EADDRINUSE :::3000`
**解决方法**：
- 更改端口：`PORT=3001 node server.js`
- 或者停止占用端口的程序

### 问题2：MQTT连接失败
**错误信息**：`MQTT 连接错误`
**解决方法**：
- 检查网络连接
- 确认防火墙设置
- 验证MQTT服务器地址

### 问题3：依赖安装失败
**错误信息**：`npm install` 失败
**解决方法**：
```bash
# 清除缓存重试
npm cache clean --force
npm install

# 或使用淘宝镜像
npm install --registry https://registry.npmmirror.com
```

---

## 📱 使用说明

### 主要功能
1. **实时监控**：查看4个区域的温度和功率
2. **历史查询**：选择日期范围查询历史数据
3. **图表分析**：温度趋势图表，支持滑动浏览

### 操作指南
1. 打开浏览器访问系统地址
2. 实时数据会自动显示在卡片中
3. 使用"历史数据查询"功能查看过往数据
4. 拖动图表下方的滑动条浏览历史趋势

---

## 🔒 安全建议

### 基础安全
- 更改默认端口
- 设置防火墙规则
- 定期备份数据文件

### 生产环境
- 使用反向代理（Nginx/Apache）
- 配置SSL证书
- 设置访问控制

---

## 📞 技术支持

- **问题反馈**：https://github.com/Wanjiawei1/tuihuolu_web/issues
- **文档查看**：项目根目录下的技术文档
- **系统状态**：通过浏览器控制台查看详细日志

---

## 📋 部署检查清单

- [ ] Node.js 环境已安装
- [ ] 代码已下载到目标目录
- [ ] 依赖包安装成功
- [ ] 服务启动正常
- [ ] 浏览器可以访问系统
- [ ] MQTT连接成功
- [ ] 实时数据正常显示

---

**部署时间**：约3-5分钟  
**维护难度**：简单  
**系统要求**：1核2G内存即可
